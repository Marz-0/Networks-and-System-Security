# signature_scan.py
import os
import re

FOLDER_TO_SCAN = "Files" 

SIGNATURES = [
    r"eval\(",
    r"base64\.b64decode",
    r"socket\.connect",
    r"exec\(",
    r"import os"
]

def scan_file(path):
    try:
        with open(path, "r", encoding="utf-8", errors="ignore") as f:
            content = f.read()
    except (FileNotFoundError, PermissionError) as e:
        print(f"Could not read {path}: {e}")
        return

    for pattern in SIGNATURES:
        if re.search(pattern, content):
            print(f"[SUSPICIOUS] {path} matches pattern: {pattern}")
            # comment out 'break' to find all matches in a file
            break

def scan_folder():
    if not os.path.isdir(FOLDER_TO_SCAN):
        print(f"Folder '{FOLDER_TO_SCAN}' does not exist.")
        return

    for name in os.listdir(FOLDER_TO_SCAN):
        full_path = os.path.join(FOLDER_TO_SCAN, name)
        if os.path.isfile(full_path):
            scan_file(full_path)

if __name__ == "__main__":
    scan_folder()
